<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>FingerprintJS + FastAPI Demo</title>
</head>
<body>
  <h1>Using FingerprintJS to fingerprint your browser...</h1>
  <pre id="output"></pre>

  <script>
  const fpPromise = import('https://openfpcdn.io/fingerprintjs/v5')
    .then(FingerprintJS => FingerprintJS.load())

  // Get the visitor ID..
  // fpPromise
  //   .then(fp => fp.get())
  //   .then(result => {
  //     // This is the visitor identifier:
  //     const visitorId = result.visitorId
  //     console.log(visitorId)
  //     console.log(result)
  //   })

    fpPromise
      .then(fp => fp.get())
      .then(result => {
        const payload = {
          visitorId: result.visitorId,
          components: result.components
        };

        document.getElementById("output").textContent = JSON.stringify(payload, null, 2);

        fetch("/submit", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        }).catch(console.error);
      });
  </script>
</body>
</html>
